(()=>{var t={103(t,e,s){const a=s(398),{formatTime:n,formatTimeHuman:o,getDailyBreakdown:i,getWeeklyBreakdown:r,getMonthlyBreakdown:l,getTimeInRange:d,getStartOfDay:c}=s(413);t.exports={StatsWebView:class{constructor(t,e){this.context=t,this.storage=e,this.panel=null}show(){if(this.panel)return this.panel.reveal(a.ViewColumn.One),void this.update();this.panel=a.window.createWebviewPanel("workTimerStats","PUNCHCARD - Work Time Statistics",a.ViewColumn.One,{enableScripts:!0,retainContextWhenHidden:!0}),this.panel.webview.html=this.getWebviewContent(),this.panel.webview.onDidReceiveMessage(async t=>{switch(t.command){case"resetProject":"Yes, Reset"===await a.window.showWarningMessage(`Are you sure you want to reset statistics for "${t.projectId}"?`,{modal:!0},"Yes, Reset")&&(await this.storage.resetProject(t.projectId),this.update(),a.window.showInformationMessage(`Statistics for "${t.projectId}" have been reset.`));break;case"resetStat":"Yes, Reset"===await a.window.showWarningMessage(`Are you sure you want to reset ${t.statLabel} for "${t.projectId}"?`,{modal:!0},"Yes, Reset")&&(await this.storage.resetProjectStat(t.projectId,t.statName),this.update(),a.window.showInformationMessage(`${t.statLabel} for "${t.projectId}" has been reset.`));break;case"resetGlobalStat":"Yes, Reset All"===await a.window.showWarningMessage(`Are you sure you want to reset ${t.statLabel} for ALL projects?`,{modal:!0},"Yes, Reset All")&&(await this.storage.resetGlobalStat(t.statName),this.update(),a.window.showInformationMessage(`${t.statLabel} has been reset for all projects.`));break;case"refresh":this.update()}},void 0,this.context.subscriptions),this.panel.onDidDispose(()=>{this.panel=null},null,this.context.subscriptions)}update(){this.panel&&(this.panel.webview.html=this.getWebviewContent())}getWebviewContent(){const t=this.storage.getAllData(),e=this.storage.getSummary(),s=t.projects,a=[];for(const t in s)a.push(...s[t].sessions);const o=i(a,7),h=r(a,4),m=l(a,6),u=c(),p=d(a,u,u+864e5);return`<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>PUNCHCARD - Work Time Statistics</title>\n    <script src="https://cdn.jsdelivr.net/npm/chart.js"><\/script>\n    <style>\n        :root {\n            --bg-color: var(--vscode-editor-background);\n            --text-color: var(--vscode-editor-foreground);\n            --border-color: var(--vscode-panel-border);\n            --card-bg: var(--vscode-editorWidget-background);\n            --accent-color: var(--vscode-button-background);\n            --accent-hover: var(--vscode-button-hoverBackground);\n            --danger-color: var(--vscode-errorForeground);\n        }\n\n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n\n        body {\n            font-family: var(--vscode-font-family);\n            background-color: var(--bg-color);\n            color: var(--text-color);\n            padding: 20px;\n            line-height: 1.6;\n        }\n\n        h1, h2, h3 {\n            margin-bottom: 15px;\n            font-weight: 600;\n        }\n\n        h1 {\n            font-size: 24px;\n            display: flex;\n            align-items: center;\n            gap: 10px;\n        }\n\n        h1::before {\n            content: "‚è±Ô∏è";\n        }\n\n        .header {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            margin-bottom: 30px;\n            padding-bottom: 15px;\n            border-bottom: 1px solid var(--border-color);\n        }\n\n        .refresh-btn {\n            background-color: var(--accent-color);\n            color: var(--vscode-button-foreground);\n            border: none;\n            padding: 8px 16px;\n            border-radius: 4px;\n            cursor: pointer;\n            font-size: 14px;\n        }\n\n        .refresh-btn:hover {\n            background-color: var(--accent-hover);\n        }\n\n        .summary-grid {\n            display: grid;\n            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n            gap: 15px;\n            margin-bottom: 30px;\n        }\n\n        .summary-card {\n            background-color: var(--card-bg);\n            border: 1px solid var(--border-color);\n            border-radius: 8px;\n            padding: 20px;\n            text-align: center;\n            position: relative;\n        }\n\n        .summary-card:hover .summary-reset-btn {\n            opacity: 1;\n        }\n\n        .summary-reset-btn {\n            position: absolute;\n            top: 5px;\n            right: 5px;\n            background: transparent;\n            border: none;\n            color: var(--danger-color);\n            cursor: pointer;\n            font-size: 10px;\n            padding: 2px 6px;\n            opacity: 0;\n            transition: opacity 0.2s;\n            border-radius: 3px;\n        }\n\n        .summary-reset-btn:hover {\n            background-color: var(--danger-color);\n            color: white;\n        }\n\n        .summary-card .value {\n            font-size: 28px;\n            font-weight: bold;\n            color: var(--accent-color);\n            margin-bottom: 5px;\n        }\n\n        .summary-card .label {\n            font-size: 12px;\n            opacity: 0.8;\n            text-transform: uppercase;\n        }\n\n        .charts-container {\n            display: grid;\n            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));\n            gap: 20px;\n            margin-bottom: 30px;\n        }\n\n        .chart-card {\n            background-color: var(--card-bg);\n            border: 1px solid var(--border-color);\n            border-radius: 8px;\n            padding: 20px;\n        }\n\n        .chart-card h3 {\n            margin-bottom: 20px;\n        }\n\n        .chart-container {\n            position: relative;\n            height: 250px;\n        }\n\n        .projects-section {\n            margin-top: 30px;\n        }\n\n        .project-card {\n            background-color: var(--card-bg);\n            border: 1px solid var(--border-color);\n            border-radius: 8px;\n            padding: 20px;\n            margin-bottom: 15px;\n        }\n\n        .project-header {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            margin-bottom: 15px;\n        }\n\n        .project-name {\n            font-size: 18px;\n            font-weight: 600;\n        }\n\n        .reset-btn {\n            background-color: transparent;\n            color: var(--danger-color);\n            border: 1px solid var(--danger-color);\n            padding: 5px 10px;\n            border-radius: 4px;\n            cursor: pointer;\n            font-size: 12px;\n        }\n\n        .reset-btn:hover {\n            background-color: var(--danger-color);\n            color: white;\n        }\n\n        .project-stats {\n            display: grid;\n            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));\n            gap: 10px;\n        }\n\n        .stat {\n            display: flex;\n            flex-direction: column;\n            position: relative;\n        }\n\n        .stat:hover .stat-reset-btn {\n            opacity: 1;\n        }\n\n        .stat-reset-btn {\n            position: absolute;\n            top: 0;\n            right: 0;\n            background: transparent;\n            border: none;\n            color: var(--danger-color);\n            cursor: pointer;\n            font-size: 10px;\n            padding: 2px 5px;\n            opacity: 0;\n            transition: opacity 0.2s;\n            border-radius: 3px;\n        }\n\n        .stat-reset-btn:hover {\n            background-color: var(--danger-color);\n            color: white;\n        }\n\n        .stat .stat-value {\n            font-size: 20px;\n            font-weight: bold;\n        }\n\n        .stat .stat-label {\n            font-size: 11px;\n            opacity: 0.7;\n            text-transform: uppercase;\n        }\n\n        .no-data {\n            text-align: center;\n            padding: 40px;\n            opacity: 0.6;\n        }\n\n        @media (max-width: 600px) {\n            .charts-container {\n                grid-template-columns: 1fr;\n            }\n        }\n    </style>\n</head>\n<body>\n    <div class="header">\n        <h1>PUNCHCARD - Work Time Statistics</h1>\n        <button class="refresh-btn" onclick="refresh()">üîÑ Refresh</button>\n    </div>\n\n    <div class="summary-grid">\n        <div class="summary-card">\n            <button class="summary-reset-btn" onclick="resetGlobalStat('totalTime', 'Total Time')">‚úï</button>\n            <div class="value">${n(e.totalTime)}</div>\n            <div class="label">Total Time</div>\n        </div>\n        <div class="summary-card">\n            <div class="value">${n(p)}</div>\n            <div class="label">Today</div>\n        </div>\n        <div class="summary-card">\n            <div class="value">${e.projectCount}</div>\n            <div class="label">Projects</div>\n        </div>\n        <div class="summary-card">\n            <button class="summary-reset-btn" onclick="resetGlobalStat('sessions', 'Sessions')">‚úï</button>\n            <div class="value">${e.totalSessions}</div>\n            <div class="label">Sessions</div>\n        </div>\n        <div class="summary-card">\n            <button class="summary-reset-btn" onclick="resetGlobalStat('keystrokes', 'Keystrokes')">‚úï</button>\n            <div class="value">${this.formatNumber(e.totalKeystrokes)}</div>\n            <div class="label">Keystrokes</div>\n        </div>\n        <div class="summary-card">\n            <button class="summary-reset-btn" onclick="resetGlobalStat('linesAdded', 'Lines Added (Typed)')">‚úï</button>\n            <div class="value">+${this.formatNumber(e.totalLinesAdded)}</div>\n            <div class="label">Lines Added (Typed)</div>\n        </div>\n        <div class="summary-card">\n            <button class="summary-reset-btn" onclick="resetGlobalStat('linesDeleted', 'Lines Deleted (Typed)')">‚úï</button>\n            <div class="value">-${this.formatNumber(e.totalLinesDeleted)}</div>\n            <div class="label">Lines Deleted (Typed)</div>\n        </div>\n        <div class="summary-card">\n            <button class="summary-reset-btn" onclick="resetGlobalStat('linesAddedBulk', 'Lines Added (Bulk)')">‚úï</button>\n            <div class="value">+${this.formatNumber(e.totalLinesAddedBulk||0)}</div>\n            <div class="label">Lines Added (Bulk/Paste)</div>\n        </div>\n        <div class="summary-card">\n            <button class="summary-reset-btn" onclick="resetGlobalStat('charactersAdded', 'Characters Added')">‚úï</button>\n            <div class="value">${this.formatNumber(e.totalCharsAdded)}</div>\n            <div class="label">Chars Added</div>\n        </div>\n    </div>\n\n    <div class="charts-container">\n        <div class="chart-card">\n            <h3>üìÖ Daily Activity (Last 7 Days)</h3>\n            <div class="chart-container">\n                <canvas id="dailyChart"></canvas>\n            </div>\n        </div>\n        <div class="chart-card">\n            <h3>üìä Weekly Activity (Last 4 Weeks)</h3>\n            <div class="chart-container">\n                <canvas id="weeklyChart"></canvas>\n            </div>\n        </div>\n        <div class="chart-card">\n            <h3>üìà Monthly Activity (Last 6 Months)</h3>\n            <div class="chart-container">\n                <canvas id="monthlyChart"></canvas>\n            </div>\n        </div>\n        <div class="chart-card">\n            <h3>ü•ß Time by Project</h3>\n            <div class="chart-container">\n                <canvas id="projectsChart"></canvas>\n            </div>\n        </div>\n    </div>\n\n    <div class="projects-section">\n        <h2>üìÅ Projects</h2>\n        ${0===Object.keys(s).length?'<div class="no-data">No projects tracked yet. Start coding to see your statistics!</div>':Object.entries(s).map(([t,e])=>`\n                <div class="project-card">\n                    <div class="project-header">\n                        <span class="project-name">${this.escapeHtml(t)}</span>\n                        <button class="reset-btn" onclick="resetProject('${this.escapeHtml(t)}')">üóëÔ∏è Reset All</button>\n                    </div>\n                    <div class="project-stats">\n                        <div class="stat">\n                            <span class="stat-value">${n(e.totalTime)}</span>\n                            <span class="stat-label">Total Time</span>\n                            <button class="stat-reset-btn" onclick="resetStat('${this.escapeHtml(t)}', 'totalTime', 'Total Time')">‚úï</button>\n                        </div>\n                        <div class="stat">\n                            <span class="stat-value">${e.sessions.length}</span>\n                            <span class="stat-label">Sessions</span>\n                            <button class="stat-reset-btn" onclick="resetStat('${this.escapeHtml(t)}', 'sessions', 'Sessions')">‚úï</button>\n                        </div>\n                        <div class="stat">\n                            <span class="stat-value">${this.formatNumber(e.keystrokes)}</span>\n                            <span class="stat-label">Keystrokes</span>\n                            <button class="stat-reset-btn" onclick="resetStat('${this.escapeHtml(t)}', 'keystrokes', 'Keystrokes')">‚úï</button>\n                        </div>\n                        <div class="stat">\n                            <span class="stat-value">+${this.formatNumber(e.linesAdded)}</span>\n                            <span class="stat-label">Lines (Typed)</span>\n                            <button class="stat-reset-btn" onclick="resetStat('${this.escapeHtml(t)}', 'linesAdded', 'Lines Added (Typed)')">‚úï</button>\n                        </div>\n                        <div class="stat">\n                            <span class="stat-value">-${this.formatNumber(e.linesDeleted)}</span>\n                            <span class="stat-label">Lines Del (Typed)</span>\n                            <button class="stat-reset-btn" onclick="resetStat('${this.escapeHtml(t)}', 'linesDeleted', 'Lines Deleted (Typed)')">‚úï</button>\n                        </div>\n                        <div class="stat">\n                            <span class="stat-value">+${this.formatNumber(e.linesAddedBulk||0)}</span>\n                            <span class="stat-label">Lines (Bulk/Paste)</span>\n                            <button class="stat-reset-btn" onclick="resetStat('${this.escapeHtml(t)}', 'linesAddedBulk', 'Lines Added (Bulk)')">‚úï</button>\n                        </div>\n                        <div class="stat">\n                            <span class="stat-value">${this.formatNumber(e.charactersAdded)}</span>\n                            <span class="stat-label">Chars Added</span>\n                            <button class="stat-reset-btn" onclick="resetStat('${this.escapeHtml(t)}', 'charactersAdded', 'Characters Added')">‚úï</button>\n                        </div>\n                        <div class="stat">\n                            <span class="stat-value">${e.lastActive?new Date(e.lastActive).toLocaleDateString():"Never"}</span>\n                            <span class="stat-label">Last Active</span>\n                        </div>\n                    </div>\n                </div>\n            `).join("")}\n    </div>\n\n    <script>\n        const vscode = acquireVsCodeApi();\n\n        function refresh() {\n            vscode.postMessage({ command: 'refresh' });\n        }\n\n        function resetProject(projectId) {\n            vscode.postMessage({ command: 'resetProject', projectId: projectId });\n        }\n\n        function resetStat(projectId, statName, statLabel) {\n            vscode.postMessage({ command: 'resetStat', projectId: projectId, statName: statName, statLabel: statLabel });\n        }\n\n        function resetGlobalStat(statName, statLabel) {\n            vscode.postMessage({ command: 'resetGlobalStat', statName: statName, statLabel: statLabel });\n        }\n\n        // Chart.js configuration\n        Chart.defaults.color = getComputedStyle(document.body).getPropertyValue('--vscode-editor-foreground') || '#ffffff';\n        Chart.defaults.borderColor = getComputedStyle(document.body).getPropertyValue('--vscode-panel-border') || '#333333';\n\n        const chartColors = [\n            '#4FC3F7', '#81C784', '#FFB74D', '#F06292', '#BA68C8',\n            '#4DD0E1', '#AED581', '#FF8A65', '#9575CD', '#7986CB'\n        ];\n\n        // Daily Chart\n        const dailyData = ${JSON.stringify(o)};\n        new Chart(document.getElementById('dailyChart'), {\n            type: 'bar',\n            data: {\n                labels: dailyData.map(d => d.date),\n                datasets: [{\n                    label: 'Hours',\n                    data: dailyData.map(d => (d.time / 3600000).toFixed(2)),\n                    backgroundColor: '#4FC3F7',\n                    borderRadius: 4\n                }]\n            },\n            options: {\n                responsive: true,\n                maintainAspectRatio: false,\n                plugins: {\n                    legend: { display: false }\n                },\n                scales: {\n                    y: {\n                        beginAtZero: true,\n                        title: { display: true, text: 'Hours' }\n                    }\n                }\n            }\n        });\n\n        // Weekly Chart\n        const weeklyData = ${JSON.stringify(h)};\n        new Chart(document.getElementById('weeklyChart'), {\n            type: 'bar',\n            data: {\n                labels: weeklyData.map(d => d.week),\n                datasets: [{\n                    label: 'Hours',\n                    data: weeklyData.map(d => (d.time / 3600000).toFixed(2)),\n                    backgroundColor: '#81C784',\n                    borderRadius: 4\n                }]\n            },\n            options: {\n                responsive: true,\n                maintainAspectRatio: false,\n                plugins: {\n                    legend: { display: false }\n                },\n                scales: {\n                    y: {\n                        beginAtZero: true,\n                        title: { display: true, text: 'Hours' }\n                    }\n                }\n            }\n        });\n\n        // Monthly Chart\n        const monthlyData = ${JSON.stringify(m)};\n        new Chart(document.getElementById('monthlyChart'), {\n            type: 'line',\n            data: {\n                labels: monthlyData.map(d => d.month),\n                datasets: [{\n                    label: 'Hours',\n                    data: monthlyData.map(d => (d.time / 3600000).toFixed(2)),\n                    borderColor: '#FFB74D',\n                    backgroundColor: 'rgba(255, 183, 77, 0.2)',\n                    fill: true,\n                    tension: 0.3\n                }]\n            },\n            options: {\n                responsive: true,\n                maintainAspectRatio: false,\n                plugins: {\n                    legend: { display: false }\n                },\n                scales: {\n                    y: {\n                        beginAtZero: true,\n                        title: { display: true, text: 'Hours' }\n                    }\n                }\n            }\n        });\n\n        // Projects Pie Chart\n        const projectsData = ${JSON.stringify(Object.entries(s).map(([t,e])=>({name:t,time:e.totalTime})))};\n        if (projectsData.length > 0) {\n            new Chart(document.getElementById('projectsChart'), {\n                type: 'doughnut',\n                data: {\n                    labels: projectsData.map(d => d.name),\n                    datasets: [{\n                        data: projectsData.map(d => (d.time / 3600000).toFixed(2)),\n                        backgroundColor: chartColors.slice(0, projectsData.length)\n                    }]\n                },\n                options: {\n                    responsive: true,\n                    maintainAspectRatio: false,\n                    plugins: {\n                        legend: {\n                            position: 'right',\n                            labels: {\n                                boxWidth: 12,\n                                padding: 10\n                            }\n                        }\n                    }\n                }\n            });\n        }\n    <\/script>\n</body>\n</html>`}formatNumber(t){return t.toLocaleString()}escapeHtml(t){const e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return t.replace(/[&<>"']/g,t=>e[t])}dispose(){this.panel&&(this.panel.dispose(),this.panel=null)}}}},140(t,e,s){const a=s(398),{getProjectId:n}=s(413),{createEmptyProjectStats:o}=s(305);t.exports={Tracker:class{constructor(t){this.storage=t,this.projectId=n(),this.isTracking=!1,this.lastActivity=Date.now(),this.sessionStartTime=0,this.currentSessionTime=0,this.isAfk=!1,this.afkThreshold=3e5,this.checkInterval=null,this.disposables=[],this.onTimeUpdateCallback=null,this.onAfkChangeCallback=null}initialize(){this.loadConfig(),this.disposables.push(a.workspace.onDidChangeConfiguration(t=>{t.affectsConfiguration("punchcardWorkTimer")&&this.loadConfig()})),a.workspace.getConfiguration("punchcardWorkTimer").get("trackOnStartup",!0)&&this.start()}loadConfig(){const t=a.workspace.getConfiguration("punchcardWorkTimer");this.afkThreshold=t.get("afkThreshold",3e5)}start(){this.isTracking||(this.isTracking=!0,this.lastActivity=Date.now(),this.sessionStartTime=Date.now(),this.currentSessionTime=0,this.isAfk=!1,this.registerActivityListeners(),this.checkInterval=setInterval(()=>this.tick(),1e3),this.storage.addSession(this.projectId,{startTime:this.sessionStartTime,endTime:this.sessionStartTime,duration:0}))}stop(){if(this.isTracking&&(this.isTracking=!1,this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null),this.disposeActivityListeners(),this.sessionStartTime>0)){const t=Date.now();this.storage.updateLastSession(this.projectId,t,this.currentSessionTime)}}registerActivityListeners(){this.disposables.push(a.workspace.onDidChangeTextDocument(t=>{this.onActivity(),this.trackDocumentChanges(t)})),this.disposables.push(a.window.onDidChangeTextEditorSelection(()=>{this.onActivity()})),this.disposables.push(a.window.onDidChangeTextEditorVisibleRanges(()=>{this.onActivity()})),this.disposables.push(a.window.onDidChangeActiveTextEditor(()=>{this.onActivity(),this.projectId=n()}))}disposeActivityListeners(){for(const t of this.disposables)t.dispose();this.disposables=[]}onActivity(){const t=this.isAfk;this.lastActivity=Date.now(),this.isAfk=!1,t&&this.onAfkChangeCallback&&(this.onAfkChangeCallback(!1),this.sessionStartTime=Date.now(),this.currentSessionTime=0,this.storage.addSession(this.projectId,{startTime:this.sessionStartTime,endTime:this.sessionStartTime,duration:0}))}trackDocumentChanges(t){if(!t.contentChanges.length)return;let e=0,s=0,a=0,n=0,o=0,i=0,r=0;for(const l of t.contentChanges){const t=l.text.length,d=l.rangeLength;a+=t,n+=d;const c=(l.text.match(/\n/g)||[]).length,h=l.range.end.line-l.range.start.line;t>10||d>10||c>3||h>3?(i+=c,r+=h):(e+=c,s+=h,(0===t&&d>0||t>0)&&(o+=1))}(o>0||a>0||n>0||e>0||s>0||i>0||r>0)&&this.storage.addMetrics(this.projectId,{linesAdded:e,linesDeleted:s,linesAddedBulk:i,linesDeletedBulk:r,charactersAdded:a,charactersDeleted:n,keystrokes:o})}tick(){if(!this.isTracking)return;const t=Date.now();t-this.lastActivity>=this.afkThreshold?this.isAfk||(this.isAfk=!0,this.storage.updateLastSession(this.projectId,this.lastActivity,this.currentSessionTime),this.onAfkChangeCallback&&this.onAfkChangeCallback(!0)):this.isAfk||(this.currentSessionTime+=1e3,this.storage.addTime(this.projectId,1e3),this.storage.updateLastSession(this.projectId,t,this.currentSessionTime),this.onTimeUpdateCallback&&this.onTimeUpdateCallback(this.currentSessionTime))}onTimeUpdate(t){this.onTimeUpdateCallback=t}onAfkChange(t){this.onAfkChangeCallback=t}getCurrentSessionTime(){return this.currentSessionTime}getTodayTime(){const t=this.storage.getProjectStats(this.projectId),e=new Date;e.setHours(0,0,0,0);const s=e.getTime();Date.now();let a=0;for(const e of t.sessions)e.startTime>=s?a+=e.duration:e.endTime>s&&(a+=e.endTime-s);return a}isCurrentlyTracking(){return this.isTracking&&!this.isAfk}getProjectId(){return this.projectId}dispose(){this.stop(),this.disposeActivityListeners()}}}},305(t){t.exports={createEmptyProjectStats:function(){return{totalTime:0,linesAdded:0,linesDeleted:0,linesAddedBulk:0,linesDeletedBulk:0,charactersAdded:0,charactersDeleted:0,keystrokes:0,sessions:[],lastActive:0}},createEmptyStorageData:function(){return{projects:{},totalTimeAllProjects:0,totalKeystrokes:0}}}},398(t){"use strict";t.exports=require("vscode")},413(t,e,s){const a=s(398);function n(t,e,s){return t.startTime<s&&t.endTime>e}function o(t,e,s){let a=0;for(const o of t)if(n(o,e,s)){const t=Math.max(o.startTime,e);a+=Math.min(o.endTime,s)-t}return a}t.exports={formatTime:function(t){t<0&&(t=0);const e=Math.floor(t/1e3),s=Math.floor(e/3600),a=Math.floor(e%3600/60),n=e%60;return`${s.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`},formatTimeHuman:function(t){t<0&&(t=0);const e=Math.floor(t/1e3),s=Math.floor(e/3600),a=Math.floor(e%3600/60),n=e%60,o=[];return s>0&&o.push(`${s}h`),a>0&&o.push(`${a}m`),(n>0||0===o.length)&&o.push(`${n}s`),o.join(" ")},getProjectId:function(){const t=a.workspace.workspaceFolders;if(!t||0===t.length)return"unknown-project";return a.workspace.name||t[0].uri.fsPath},getStartOfDay:function(){const t=new Date;return new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime()},getStartOfWeek:function(){const t=new Date,e=t.getDay(),s=t.getDate()-e+(0===e?-6:1);return new Date(t.getFullYear(),t.getMonth(),s).getTime()},getStartOfMonth:function(){const t=new Date;return new Date(t.getFullYear(),t.getMonth(),1).getTime()},isSessionInRange:n,getTimeInRange:o,getDailyBreakdown:function(t,e=7){const s=[],a=new Date;for(let n=e-1;n>=0;n--){const e=new Date(a.getFullYear(),a.getMonth(),a.getDate()-n),i=e.getTime(),r=i+864e5;s.push({date:e.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}),time:o(t,i,r)})}return s},getWeeklyBreakdown:function(t,e=4){const s=[],a=new Date,n=a.getDay(),i=a.getDate()-n+(0===n?-6:1);for(let n=e-1;n>=0;n--){const e=new Date(a.getFullYear(),a.getMonth(),i-7*n),r=new Date(e.getTime()+6048e5);s.push({week:`Week of ${e.toLocaleDateString("en-US",{month:"short",day:"numeric"})}`,time:o(t,e.getTime(),r.getTime())})}return s},getMonthlyBreakdown:function(t,e=6){const s=[],a=new Date;for(let n=e-1;n>=0;n--){const e=new Date(a.getFullYear(),a.getMonth()-n,1),i=new Date(a.getFullYear(),a.getMonth()-n+1,1);s.push({month:e.toLocaleDateString("en-US",{month:"long",year:"numeric"}),time:o(t,e.getTime(),i.getTime())})}return s}}},497(t,e,s){const a=s(398),{Storage:n}=s(829),{Tracker:o}=s(140),{StatusBar:i}=s(523),{StatsWebView:r}=s(103);let l,d,c,h;t.exports={activate:async function(t){console.log("PUNCHCARD - Work Time Statistics is now active!"),l=new n(t),await l.initialize(),d=new o(l),d.initialize(),c=new i(d),c.initialize(),h=new r(t,l);const e=a.commands.registerCommand("workTimer.showStats",()=>{h.show()}),s=a.commands.registerCommand("workTimer.resetProject",async()=>{const t=d.getProjectId();"Yes, Reset"===await a.window.showWarningMessage(`Are you sure you want to reset statistics for "${t}"?`,{modal:!0},"Yes, Reset")&&(await l.resetProject(t),a.window.showInformationMessage(`Statistics for "${t}" have been reset.`))}),m=a.commands.registerCommand("workTimer.resetAll",async()=>{"Yes, Reset All"===await a.window.showWarningMessage("Are you sure you want to reset ALL statistics? This cannot be undone.",{modal:!0},"Yes, Reset All")&&(await l.resetAll(),a.window.showInformationMessage("All statistics have been reset."))}),u=a.commands.registerCommand("workTimer.exportData",async()=>{const t=l.getAllData(),e=JSON.stringify(t,null,2),s=await a.window.showSaveDialog({defaultUri:a.Uri.file("punchcard-stats.json"),filters:{"JSON Files":["json"]}});s&&(await a.workspace.fs.writeFile(s,Buffer.from(e,"utf8")),a.window.showInformationMessage(`Statistics exported to ${s.fsPath}`))}),p=a.commands.registerCommand("workTimer.importData",async()=>{const t=await a.window.showOpenDialog({canSelectFiles:!0,canSelectFolders:!1,canSelectMany:!1,filters:{"JSON Files":["json"]}});if(t&&t[0])try{const e=await a.workspace.fs.readFile(t[0]),s=JSON.parse(Buffer.from(e).toString("utf8"));s&&s.projects?"Yes, Import"===await a.window.showWarningMessage("This will merge imported data with existing data. Continue?",{modal:!0},"Yes, Import")&&(await l.importData(s),a.window.showInformationMessage("Data imported successfully!")):a.window.showErrorMessage("Invalid data format. Expected a valid PUNCHCARD export file.")}catch(t){a.window.showErrorMessage(`Failed to import data: ${t.message}`)}}),g=a.commands.registerCommand("workTimer.checkSync",async()=>{const t=l.getAllData(),e=Object.keys(t.projects).length,s=t.totalTimeAllProjects,n=["üìä PUNCHCARD Sync Status","",`Projects tracked: ${e}`,`Total time: ${Math.floor(s/36e5)}h ${Math.floor(s%36e5/6e4)}m`,`Total keystrokes: ${t.totalKeystrokes}`,"","‚öôÔ∏è For sync to work:",'1. Settings Sync must be ON (Ctrl+Shift+P ‚Üí "Settings Sync: Turn On")','2. "UI State" must be checked in sync settings',"3. Same Microsoft/GitHub account on both machines",'4. Run "Settings Sync: Sync Now" to force sync',"","Note: Sync may take a few minutes. Reload VS Code after syncing."].join("\n");a.window.showInformationMessage(n,{modal:!0})});t.subscriptions.push(e,s,m,u,p,g),t.subscriptions.push({dispose:()=>{d.dispose(),c.dispose(),h.dispose()}})},deactivate:function(){d&&d.dispose(),c&&c.dispose(),h&&h.dispose()}}},523(t,e,s){const a=s(398),{formatTime:n}=s(413);t.exports={StatusBar:class{constructor(t){this.tracker=t,this.statusBarItem=a.window.createStatusBarItem(a.StatusBarAlignment.Left,100),this.statusBarItem.command="workTimer.showStats",this.statusBarItem.tooltip="Click to view work time statistics",this.updateInterval=null}initialize(){this.statusBarItem.show(),this.update(),this.updateInterval=setInterval(()=>this.update(),1e3),this.tracker.onTimeUpdate(()=>this.update()),this.tracker.onAfkChange(t=>this.updateAfkStatus(t))}update(){const t=this.tracker.getCurrentSessionTime(),e=this.tracker.getTodayTime(),s=this.tracker.isCurrentlyTracking(),o=n(t),i=n(e),r=s?"$(clock)":"$(debug-pause)";this.statusBarItem.text=`${r} ${o} | Today: ${i}`,this.statusBarItem.backgroundColor=s?void 0:new a.ThemeColor("statusBarItem.warningBackground")}updateAfkStatus(t){t?(this.statusBarItem.text=`$(debug-pause) AFK - ${this.statusBarItem.text.split(" | ")[1]||""}`,this.statusBarItem.backgroundColor=new a.ThemeColor("statusBarItem.warningBackground")):(this.statusBarItem.backgroundColor=void 0,this.update())}dispose(){this.updateInterval&&(clearInterval(this.updateInterval),this.updateInterval=null),this.statusBarItem.dispose()}}}},829(t,e,s){const{createEmptyProjectStats:a,createEmptyStorageData:n}=s(305),o="punchcard-work-stats",i=[o];t.exports={Storage:class{constructor(t){this.context=t,this.data=n(),this.initialized=!1,this.syncCheckTimeout=null}async initialize(){this.context.globalState.setKeysForSync(i),await this.load(),this.initialized=!0,console.log("PUNCHCARD: Storage initialized"),console.log("PUNCHCARD: Sync keys registered:",i),console.log("PUNCHCARD: Data loaded, projects:",Object.keys(this.data.projects).length),this.scheduleSyncCheck()}scheduleSyncCheck(){[5e3,15e3,3e4].forEach(t=>{setTimeout(async()=>{await this.checkForSyncedData()},t)})}async checkForSyncedData(){const t=this.context.globalState.get(o);if(!t||!t.projects)return;const e=Object.keys(t.projects).length,s=Object.keys(this.data.projects).length,a=t.totalTimeAllProjects||0,n=this.data.totalTimeAllProjects||0;(e>s||a>n)&&(console.log("PUNCHCARD: Detected synced data, merging..."),this.mergeWithSyncedData(t),await this.save())}mergeWithSyncedData(t){for(const e in t.projects){const s=t.projects[e];if(this.data.projects[e]){const t=this.data.projects[e];this.data.projects[e]={totalTime:Math.max(t.totalTime||0,s.totalTime||0),linesAdded:Math.max(t.linesAdded||0,s.linesAdded||0),linesDeleted:Math.max(t.linesDeleted||0,s.linesDeleted||0),linesAddedBulk:Math.max(t.linesAddedBulk||0,s.linesAddedBulk||0),linesDeletedBulk:Math.max(t.linesDeletedBulk||0,s.linesDeletedBulk||0),charactersAdded:Math.max(t.charactersAdded||0,s.charactersAdded||0),charactersDeleted:Math.max(t.charactersDeleted||0,s.charactersDeleted||0),keystrokes:Math.max(t.keystrokes||0,s.keystrokes||0),sessions:this.mergeSessions(t.sessions||[],s.sessions||[]),lastActive:Math.max(t.lastActive||0,s.lastActive||0)}}else this.data.projects[e]=s}this.recalculateTotals()}mergeSessions(t,e){const s=new Map;for(const e of t)s.set(e.startTime,e);for(const t of e)s.has(t.startTime)||s.set(t.startTime,t);return Array.from(s.values()).sort((t,e)=>t.startTime-e.startTime)}recalculateTotals(){this.data.totalTimeAllProjects=0,this.data.totalKeystrokes=0;for(const t in this.data.projects)this.data.totalTimeAllProjects+=this.data.projects[t].totalTime||0,this.data.totalKeystrokes+=this.data.projects[t].keystrokes||0}async load(){const t=this.context.globalState.get(o);t?(this.data={projects:t.projects||{},totalTimeAllProjects:t.totalTimeAllProjects||0,totalKeystrokes:t.totalKeystrokes||0},console.log("PUNCHCARD: Loaded existing data from globalState")):(this.data=n(),console.log("PUNCHCARD: No existing data, starting fresh"))}async save(){await this.context.globalState.update(o,this.data)}getProjectStats(t){return this.data.projects[t]||(this.data.projects[t]=a()),this.data.projects[t]}async updateProjectStats(t,e){const s=this.getProjectStats(t);Object.assign(s,e),await this.save()}async addTime(t,e){const s=this.getProjectStats(t);s.totalTime+=e,s.lastActive=Date.now(),this.data.totalTimeAllProjects+=e,await this.save()}async addSession(t,e){this.getProjectStats(t).sessions.push(e),await this.save()}async updateLastSession(t,e,s){const a=this.getProjectStats(t);if(a.sessions.length>0){const t=a.sessions[a.sessions.length-1];t.endTime=e,t.duration=s,await this.save()}}async addMetrics(t,e){const s=this.getProjectStats(t);e.linesAdded&&(s.linesAdded+=e.linesAdded),e.linesDeleted&&(s.linesDeleted+=e.linesDeleted),e.linesAddedBulk&&("number"!=typeof s.linesAddedBulk&&(s.linesAddedBulk=0),s.linesAddedBulk+=e.linesAddedBulk),e.linesDeletedBulk&&("number"!=typeof s.linesDeletedBulk&&(s.linesDeletedBulk=0),s.linesDeletedBulk+=e.linesDeletedBulk),e.charactersAdded&&(s.charactersAdded+=e.charactersAdded),e.charactersDeleted&&(s.charactersDeleted+=e.charactersDeleted),e.keystrokes&&(s.keystrokes+=e.keystrokes,this.data.totalKeystrokes+=e.keystrokes),s.lastActive=Date.now(),await this.save()}async resetProjectStat(t,e){if(!this.data.projects[t])return;const s=this.data.projects[t];switch(e){case"keystrokes":this.data.totalKeystrokes-=s.keystrokes||0,s.keystrokes=0;break;case"linesAdded":s.linesAdded=0;break;case"linesDeleted":s.linesDeleted=0;break;case"linesAddedBulk":s.linesAddedBulk=0;break;case"linesDeletedBulk":s.linesDeletedBulk=0;break;case"charactersAdded":s.charactersAdded=0;break;case"charactersDeleted":s.charactersDeleted=0;break;case"totalTime":this.data.totalTimeAllProjects-=s.totalTime||0,s.totalTime=0;break;case"sessions":s.sessions=[];break;case"allLines":s.linesAdded=0,s.linesDeleted=0,s.linesAddedBulk=0,s.linesDeletedBulk=0;break;case"allChars":s.charactersAdded=0,s.charactersDeleted=0}await this.save()}async resetGlobalStat(t){for(const e in this.data.projects){const s=this.data.projects[e];switch(t){case"keystrokes":s.keystrokes=0;break;case"linesAdded":s.linesAdded=0;break;case"linesDeleted":s.linesDeleted=0;break;case"linesAddedBulk":s.linesAddedBulk=0;break;case"linesDeletedBulk":s.linesDeletedBulk=0;break;case"charactersAdded":s.charactersAdded=0;break;case"charactersDeleted":s.charactersDeleted=0;break;case"totalTime":s.totalTime=0;break;case"sessions":s.sessions=[]}}"keystrokes"===t&&(this.data.totalKeystrokes=0),"totalTime"===t&&(this.data.totalTimeAllProjects=0),await this.save()}async resetProject(t){if(this.data.projects[t]){const e=this.data.projects[t];this.data.totalTimeAllProjects-=e.totalTime,this.data.totalKeystrokes-=e.keystrokes,delete this.data.projects[t],await this.save()}}async resetAll(){this.data=n(),await this.save()}async importData(t){if(!t||!t.projects)throw new Error("Invalid data format");for(const e in t.projects){const s=t.projects[e];if(this.data.projects[e]){const t=this.data.projects[e];this.data.projects[e]={totalTime:Math.max(t.totalTime||0,s.totalTime||0),linesAdded:Math.max(t.linesAdded||0,s.linesAdded||0),linesDeleted:Math.max(t.linesDeleted||0,s.linesDeleted||0),linesAddedBulk:Math.max(t.linesAddedBulk||0,s.linesAddedBulk||0),linesDeletedBulk:Math.max(t.linesDeletedBulk||0,s.linesDeletedBulk||0),charactersAdded:Math.max(t.charactersAdded||0,s.charactersAdded||0),charactersDeleted:Math.max(t.charactersDeleted||0,s.charactersDeleted||0),keystrokes:Math.max(t.keystrokes||0,s.keystrokes||0),sessions:[...t.sessions||[],...s.sessions||[]],lastActive:Math.max(t.lastActive||0,s.lastActive||0)}}else this.data.projects[e]=s}this.data.totalTimeAllProjects=0,this.data.totalKeystrokes=0;for(const t in this.data.projects)this.data.totalTimeAllProjects+=this.data.projects[t].totalTime||0,this.data.totalKeystrokes+=this.data.projects[t].keystrokes||0;await this.save()}getAllData(){return{...this.data}}getSummary(){const t=Object.keys(this.data.projects).length;let e=0,s=0,a=0,n=0,o=0,i=0,r=0;for(const t in this.data.projects){const l=this.data.projects[t];e+=l.sessions.length,s+=l.linesAdded||0,a+=l.linesDeleted||0,n+=l.linesAddedBulk||0,o+=l.linesDeletedBulk||0,i+=l.charactersAdded||0,r+=l.charactersDeleted||0}return{projectCount:t,totalTime:this.data.totalTimeAllProjects,totalKeystrokes:this.data.totalKeystrokes,totalSessions:e,totalLinesAdded:s,totalLinesDeleted:a,totalLinesAddedBulk:n,totalLinesDeletedBulk:o,totalCharsAdded:i,totalCharsDeleted:r}}},STORAGE_KEY:o}}},e={},s=function s(a){var n=e[a];if(void 0!==n)return n.exports;var o=e[a]={exports:{}};return t[a](o,o.exports,s),o.exports}(497);module.exports=s})();